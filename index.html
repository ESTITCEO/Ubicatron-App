<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ubicatron</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --main-bg: #1a1a1a;
            --card-bg: #2a2a2a;
            --accent-color: #6c5ce7;
        }
        
        body { 
            background-color: var(--main-bg); 
            color: white;
            min-height: 100vh;
        }
        
        .card { 
            background-color: var(--card-bg);
            border: 1px solid #3a3a3a;
            border-radius: 15px;
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .font-selector {
            background: #3a3a3a;
            color: white;
            border: 1px solid #4a4a4a;
            border-radius: 5px;
            padding: 5px;
        }
        
        .preview-card {
            max-width: 400px;
            margin: 0 auto;
            box-shadow: 0 0 15px rgba(108, 92, 231, 0.3);
        }

        .input-group-text, .form-control {
            background-color: #3a3a3a !important;
            border-color: #4a4a4a !important;
            color: white !important;
        }
        
        .form-control::placeholder {
            color: #cccccc !important;
        }
        
        /* Títulos en blanco */
        h1, h3, h5, .form-label, .modal-title {
            color: white !important;
        }
        
        .input-group-text i {
            color: white !important;
        }
        
        /* Nuevos estilos para sección dual */
        .seccion-dual {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
        }
        
        .switch-seccion {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .switch-seccion:hover {
            transform: scale(1.05);
        }

        /* Estilo para el texto dentro del modal */
        .modal-content {
            color: white !important; /* Asegura que el texto sea blanco */
        }

        /* Estilo para los textos dentro del modal */
        .modal-body p, .modal-body h3, .modal-body i {
            color: white !important; /* Asegura que todos los textos e iconos sean blancos */
        }

        /* Estilo específico para la descripción en el modal */
        .modal-body .text-muted {
            color: #cccccc !important; /* Cambia el color de la descripción a gris claro */
        }

        /* Estilo para las tarjetas publicadas */
        #lista-contenido .card-body p,
        #lista-contenido .card-body i {
            color: white !important; /* Asegura que los textos e iconos sean blancos */
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1 class="text-center mb-4">Ubicatron <i class="fa-solid fa-eye"></i></h1>

        <!-- Selector de Sección -->
        <div class="d-flex gap-3 justify-content-center mb-4">
            <button class="btn btn-outline-primary switch-seccion active" data-seccion="volantes">
                <i class="fa-solid fa-paste"></i> Volantes
            </button>
            <button class="btn btn-outline-primary switch-seccion" data-seccion="negocios">
                <i class="fa-solid fa-store"></i> Negocios
            </button>
        </div>

        <!-- Sección Volantes -->
        <div class="seccion-contenido" id="seccion-volantes">
            <div class="card p-4 mb-4">
                <h3 class="mb-4">🛠 Crear Nuevo Volante</h3>
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label">Seleccionar tipografía:</label>
                        <select class="form-select font-selector volante-font">
                            <option value="Arial">Arial</option>
                            <option value="Roboto">Roboto</option>
                            <option value="Montserrat">Montserrat</option>
                            <option value="Open Sans">Open Sans</option>
                            <option value="Poppins">Poppins</option>
                        </select>
                    </div>

                    <div class="col-md-6">
                        <div class="input-group">
                            <span class="input-group-text"><i class="fa-regular fa-user"></i></span>
                            <input type="text" class="form-control volante-nombre" placeholder="Título del volante">
                        </div>
                    </div>
                    
                    <div class="col-12">
                        <div class="input-group">
                            <span class="input-group-text"><i class="fa-regular fa-file"></i></span>
                            <input type="text" class="form-control volante-desc" placeholder="Descripción del volante">
                        </div>
                    </div>
                    
                    <div class="col-12">
                        <div class="input-group">
                            <span class="input-group-text"><i class="fa-solid fa-image"></i></span>
                            <input type="file" class="form-control volante-imagen" accept="image/*">
                        </div>
                    </div>

                    <div class="col-12 d-flex gap-2">
                        <button class="btn btn-outline-primary" onclick="mostrarPreview('volante')">
                            <i class="fa-regular fa-eye"></i> Vista Previa
                        </button>
                        <button class="btn btn-primary" onclick="publicar('volante')">
                            <i class="fa-solid fa-paper-plane"></i> Publicar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sección Negocios -->
        <div class="seccion-contenido d-none" id="seccion-negocios">
            <div class="card p-4 mb-4">
                <h3 class="mb-4">🏪 Registrar Negocio</h3>
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label">Seleccionar tipografía:</label>
                        <select class="form-select font-selector negocio-font">
                            <option value="Arial">Arial</option>
                            <option value="Roboto">Roboto</option>
                            <option value="Montserrat">Montserrat</option>
                            <option value="Open Sans">Open Sans</option>
                            <option value="Poppins">Poppins</option>
                        </select>
                    </div>

                    <div class="col-md-6">
                        <div class="input-group">
                            <span class="input-group-text"><i class="fa-regular fa-user"></i></span>
                            <input type="text" class="form-control negocio-nombre" placeholder="Nombre del negocio">
                        </div>
                    </div>
                    
                    <div class="col-12">
                        <div class="input-group">
                            <span class="input-group-text"><i class="fa-regular fa-file"></i></span>
                            <input type="text" class="form-control negocio-tipo" placeholder="Tipo de negocio">
                        </div>
                    </div>
                    
                    <div class="col-12">
                        <div class="input-group">
                            <span class="input-group-text"><i class="fa-solid fa-location-dot"></i></span>
                            <input type="text" class="form-control negocio-direccion" placeholder="Dirección completa">
                        </div>
                    </div>
                    
                    <div class="col-12">
                        <div class="input-group">
                            <span class="input-group-text"><i class="fa-solid fa-image"></i></span>
                            <input type="file" class="form-control negocio-imagen" accept="image/*">
                        </div>
                    </div>

                    <div class="col-12 d-flex gap-2">
                        <button class="btn btn-outline-primary" onclick="mostrarPreview('negocio')">
                            <i class="fa-regular fa-eye"></i> Vista Previa
                        </button>
                        <button class="btn btn-primary" onclick="publicar('negocio')">
                            <i class="fa-solid fa-paper-plane"></i> Registrar
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de Vista Previa -->
        <div class="modal fade" id="previewModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content bg-dark">
                    <div class="modal-header">
                        <h5 class="modal-title">Vista Previa</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body" id="previewContent"></div>
                </div>
            </div>
        </div>

        <!-- Contenido Publicado -->
        <h3 class="mt-5 mb-3">📌 Contenido Publicado</h3>
        <div id="lista-contenido" class="row g-4"></div>
    </div>

    <script>
        let contenido = JSON.parse(localStorage.getItem('ubicatron')) || [];
        let currentPreview = null;

        // Switch entre secciones
        document.querySelectorAll('.switch-seccion').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.switch-seccion').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                document.querySelectorAll('.seccion-contenido').forEach(sec => sec.classList.add('d-none'));
                document.getElementById(`seccion-${this.dataset.seccion}`).classList.remove('d-none');
            });
        });

        function mostrarPreview(tipo) {
            const campos = obtenerCampos(tipo);
            if (!validarCampos(campos)) {
                mostrarMensaje('Completa todos los campos requeridos', 'warning');
                return;
            }

            const reader = new FileReader();
            reader.onload = e => {
                const previewHTML = crearPreview(tipo, campos, e.target.result);
                document.getElementById('previewContent').innerHTML = previewHTML;
                currentPreview = { tipo, ...campos, imagen: e.target.result };
                new bootstrap.Modal(document.getElementById('previewModal')).show();
            };
            reader.readAsDataURL(campos.imagen);
        }

        function publicar(tipo) {
            const campos = obtenerCampos(tipo);
            if (!validarCampos(campos)) {
                mostrarMensaje('Completa todos los campos requeridos', 'warning');
                return;
            }

            const reader = new FileReader();
            reader.onload = e => {
                const nuevoContenido = { tipo, ...campos, imagen: e.target.result };
                contenido.unshift(nuevoContenido);
                localStorage.setItem('ubicatron', JSON.stringify(contenido));
                crearElementoContenido(nuevoContenido);
                resetForm(tipo);
                mostrarMensaje(tipo === 'volante' ? 'Volante publicado!' : 'Negocio registrado!', 'success');
            };
            reader.readAsDataURL(campos.imagen);
        }

        function obtenerCampos(tipo) {
            const prefix = tipo === 'volante' ? '.volante-' : '.negocio-';
            return {
                nombre: document.querySelector(`${prefix}nombre`).value,
                tipo: tipo === 'volante' ? document.querySelector(`${prefix}desc`).value 
                       : document.querySelector(`${prefix}tipo`).value,
                direccion: tipo === 'negocio' ? document.querySelector(`${prefix}direccion`).value : '',
                imagen: document.querySelector(`${prefix}imagen`).files[0],
                fuente: document.querySelector(`${prefix}font`).value
            };
        }

        function validarCampos({ nombre, tipo, direccion, imagen }) {
            if (!nombre || !tipo || !imagen || (direccion === '' && tipo === 'negocio')) {
                return false;
            }
            return true;
        }

        function crearPreview(tipo, campos, imagen) {
            return `
                <div class="card preview-card" style="font-family: ${campos.fuente}">
                    <img src="${imagen}" class="card-img-top" style="height: 200px; object-fit: cover">
                    <div class="card-body">
                        <h3>${campos.nombre}</h3>
                        <p class="text-muted">${campos.tipo}</p>
                        ${tipo === 'negocio' ? `<p><i class="fa-solid fa-location-dot"></i> ${campos.direccion}</p>` : ''}
                    </div>
                </div>`;
        }

        function crearElementoContenido(item) {
            const contenedor = document.getElementById('lista-contenido');
            const card = document.createElement('div');
            card.classList.add('col-md-4', 'mb-3');
            card.innerHTML = `
                <div class="card preview-card" style="font-family: ${item.fuente}">
                    <img src="${item.imagen}" class="card-img-top" style="height: 200px; object-fit: cover">
                    <div class="card-body">
                        <h3>${item.nombre}</h3>
                        <p class="text-muted">${item.tipo}</p>
                        ${item.tipo === 'negocio' ? `<p><i class="fa-solid fa-location-dot"></i> ${item.direccion}</p>` : ''}
                        <div class="text-center mt-2">
                            <button class="btn btn-sm btn-danger" onclick="eliminarContenido('${item.nombre}')">
                                <i class="fa-solid fa-trash"></i> Eliminar
                            </button>
                        </div>
                    </div>
                </div>`;
            contenedor.prepend(card);
        }

        function eliminarContenido(nombre) {
            contenido = contenido.filter(item => item.nombre !== nombre);
            localStorage.setItem('ubicatron', JSON.stringify(contenido));
            location.reload();
        }

        function resetForm(tipo) {
            const prefix = tipo === 'volante' ? '.volante-' : '.negocio-';
            document.querySelectorAll(`${prefix}nombre, ${prefix}desc, ${prefix}tipo, ${prefix}direccion`).forEach(input => {
                input.value = '';
            });
            document.querySelector(`${prefix}imagen`).value = '';
        }

        function mostrarMensaje(texto, tipo) {
            const alerta = document.createElement('div');
            alerta.className = `alert alert-${tipo} alert-dismissible fade show fixed-top m-3`;
            alerta.innerHTML = `
                ${texto}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>`;
            document.body.prepend(alerta);
            setTimeout(() => alerta.remove(), 3000);
        }

        // Cargar contenido al iniciar
        window.addEventListener('DOMContentLoaded', () => {
            contenido.forEach(item => crearElementoContenido(item));
        });
    </script>
</body>
</html>